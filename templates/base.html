<!DOCTYPE html>
{% load staticfiles %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700"
          rel="stylesheet">

    <!-- Animate.css -->
    <link rel="stylesheet" href="{% static 'css/animate.css' %}">
    <!-- Icomoon Icon Fonts-->
    <link rel="stylesheet" href="{% static 'css/icomoon.css' %}">
    <!-- Bootstrap  -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">

    <!-- Magnific Popup -->
    <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}">

    <!-- Flexslider  -->
    <link rel="stylesheet" href="{% static 'css/flexslider.css' %}">

    <!-- Owl Carousel -->
    <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl.theme.default.min.css' %}">

    <!-- Date Picker -->
    <link rel="stylesheet" href="{% static 'css/bootstrap-datepicker.css' %}">
    <!-- Flaticons  -->
    <link rel="stylesheet" href="{% static 'fonts/flaticon/font/flaticon.css' %}">

    <!-- Theme style  -->
    <link rel="stylesheet" href="{% static 'css/style.css' %}">

    <!-- Modernizr JS -->
    <script src="{% static 'js/modernizr-2.6.2.min.js' %}"></script>
    <!-- FOR IE9 below -->
    <!--[if lt IE 9]>
	<script src="{% static 'js/respond.min.js' %}"></script>
	<![endif]-->
</head>
<body>
<div id="page">
    {% include 'base/menu.html' %}
    {% include 'base/aside.html' %}

    <div class="colorlib-shop">
        <div class="container">
            {% block content %}

            {% endblock content %}
        </div>
    </div>

    {% include 'base/footer.html' %}
</div>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<script src="{% static 'js/vue.js' %}"></script>
<!-- jQuery -->
<script src="{% static 'js/jquery.min.js' %}"></script>
<!-- jQuery Easing -->
<script src="{% static 'js/jquery.easing.1.3.js' %}"></script>
<!-- Bootstrap -->
<script src="{% static 'js/bootstrap.min.js' %}"></script>
<!-- Waypoints -->
<script src="{% static 'js/jquery.waypoints.min.js' %}"></script>
<!-- Flexslider -->
<script src="{% static 'js/jquery.flexslider-min.js' %}"></script>
<!-- Owl carousel -->
<script src="{% static 'js/owl.carousel.min.js' %}"></script>
<!-- Magnific Popup -->
<script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
<script src="{% static 'js/magnific-popup-options.js' %}"></script>
<!-- Date Picker -->
<script src="{% static 'js/bootstrap-datepicker.js' %}"></script>
<!-- Stellar Parallax -->
<script src="{% static 'js/jquery.stellar.min.js' %}"></script>
<!-- Main -->
<script src="{% static 'js/main.js' %}"></script>

<script>
$(document).ready(function(){
    let csrftoken = Cookies.get('csrftoken');
    $.ajaxSetup({
        headers: {"X-CSRFToken": csrftoken}
    });

    category = '';
    availability = 'True';

    $("#sort-category a").click(function () {
        console.log(this.value);
        console.log($(this).text());
        category = $(this).text();
    });

    $("#availability a").click(function () {
        console.log($(this).text());
        availability = $(this).text();
    });

    $("#sort-product").click(function () {
      //сортировка по фильтрам
      var data = {};
      data.category = category;
      data.price1 = +$("select#price-from option:selected").text();
      data.price2 = +$("select#price-to option:selected").text();
      data.availability = availability;
      data.url = "http://127.0.0.1:8000/sort-jquery/";

      $.ajax({
        url: this.url,
        type: "POST",
        data: data,
        success: (response) => {
            console.log('response', response);
            $("#product-list").empty();

            var i = 0;
            //циклом вывожу картинки
            while(i < response.length){
                var list = '<div class="col-md-4 text-center">\
                                <div class="product-entry">\
                                    <div class="product-img"\
                                         style="background-image: url(' + response[i].photo.image + ');">\
                                        <p class="tag"><span class="new">New</span></p>\
                                        <div class="cart">\
                                            <p>\
                                                <span class="addtocart"><a href="cart.html"><i class="icon-shopping-cart"></i></a></span>\
                                                <span><a href="product-detail.html"><i class="icon-eye"></i></a></span>\
                                                <span><a href="#"><i class="icon-heart3"></i></a></span>\
                                                <span><a href="add-to-wishlist.html"><i class="icon-bar-chart"></i></a></span>\
                                            </p>\
                                        </div>\
                                    </div>\
                                    <div class="desc">\
                                        <h3><a href="' + response[i].slug + '">' + response[i].title + '</a></h3>\
                                        <p class="price"><span>' + response[i].price + '</span></p>\
                                    </div>\
                                </div>\
                            </div>';

                $("#product-list").append(list);
                i++;
            }
        }
      })

      // блокировка перехода на другую страницу
      return false;
    });
});
</script>

{% block script_vue %}
{% endblock script_vue %}
</body>
</html>